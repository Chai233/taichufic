import{o as S,m as r,p as s}from "./index-CAxVsxW7.js";import{F as b,d as I}from "./download-B3G9UKAv.js";import{R,a as k,I as $}from "./index-DFFGqAXv.js";import{u as C,e as z,v as P,f as U}from "./use-workflow-CDiK9Fwk.js";import{w as n}from "./request-CQ5xDpzU.js";import{o as m}from "./oss-static-Ca53zxmx.js";import{c as E}from "./classnames-eG4m7NsW.js";import{R as F}from "./DownloadOutlined-CiunfTbT.js";import{I as G}from "./index-DNQMr9HO.js";import"./CheckCircleFilled-CyhmoFhe.js";const{TextArea:W}=G,O=()=>{var d;const u=S(),[o,h]=r.useState(0),[i,x]=r.useState(0),[l,p]=r.useState(0),[j,g]=r.useState(""),{workflow:v}=C(),{workflowId:t}=v||{},{data:e,run:N}=n(z,{ready:!!t,defaultParams:[{workflowId:t}]}),{run:f}=n(U,{manual:!0,onSuccess:()=>{N({workflowId:t})}}),{run:w}=n(P,{manual:!0,onSuccess:()=>{u("/flow/result",{replace:!0})}}),y=()=>{var a;f({workflowId:t,storyboardId:(a=e==null?void 0:e[o])==null?void 0:a.storyboardId,scale:i,styleScale:l,userPrompt:j})};return s.jsx(b,{onDownloadStoryboard:()=>{I(`/api/v1/storyboard/download?workflowId=${t}`,`${new Date}-分镜`)},onYeildMove:()=>{w({workflowId:t})},children:s.jsxs("div",{className:"storyboard",children:[s.jsxs("div",{className:"storyboard-head",children:[s.jsx("div",{className:"storyboard-head-title"}),s.jsxs("div",{className:"storyboard-head-desc",children:[s.jsx("img",{src:"https://taichu-static.oss-cn-hangzhou.aliyuncs.com/photo/img-icon.png",className:"icon"}),s.jsxs("span",{children:["共",s.jsx("span",{className:"variable",children:(e==null?void 0:e.length)||0}),"张精彩分镜,当前第",s.jsx("span",{className:"variable",children:o+1}),"张"]})]})]}),s.jsxs("div",{className:"storyboard-content",children:[s.jsxs("div",{className:"storyboard-content-image",children:[s.jsxs("div",{className:"main-carousel",children:[s.jsx("img",{src:e?m((d=e==null?void 0:e[o])==null?void 0:d.imgUrl):"",alt:`image ${o+1}`}),s.jsx(F,{className:"download"})]}),s.jsxs("div",{className:"sub-carousel",children:[s.jsxs("div",{className:"sub-carousel-title",children:[s.jsx("span",{className:"text",children:"精彩分镜"}),s.jsxs("div",{className:"arrows",children:[s.jsx(R,{}),s.jsx(k,{})]})]}),s.jsx("div",{className:"sub-carousel-content",children:e==null?void 0:e.map((a, c)=>s.jsxs("div",{className:E("image-item",o===c&&"image-item-checked"),onClick:()=>h(c),children:[s.jsx("img",{src:m(a.imgUrl),alt:`image ${c+1}`}),s.jsx("div",{className:"shadow",children:`分镜${c+1}`})]},a.storyboardId))})]})]}),s.jsxs("div",{className:"storyboard-content-edit",children:[s.jsx($,{label:"画面调节",scale:i,styleScale:l,onScale:x,onStyleScale:p}),s.jsxs("div",{className:"edit-textarea",children:[s.jsxs("div",{className:"edit-textarea-title",children:[s.jsxs("span",{className:"edit",children:[s.jsx("img",{src:"https://taichu-static.oss-cn-hangzhou.aliyuncs.com/photo/upload-beautify.png",alt:""})," 分镜修改"]}),s.jsxs("span",{className:"revise",children:[s.jsx("img",{src:"https://taichu-static.oss-cn-hangzhou.aliyuncs.com/photo/select-icon.png",alt:""})," 框选局部调整"]})]}),s.jsx(W,{className:"edit-textarea-content",placeholder:"傍晚的城市街道上，霓虹渐渐亮起，人们步履匆匆，街边的咖啡馆温暖明亮。寂静的小镇街道，路灯昏暗",autoSize:{minRows:4},allowClear:!0,showCount:!0,maxLength:150,onChange: a=>g(a.target.value)})]}),s.jsx("div",{className:"edit-btn",onClick:y,children:"立即生成"})]})]})]})})};export{O as default};
